(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function e(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(a){if(a.ep)return;a.ep=!0;const i=e(a);fetch(a.href,i)}})();function P(t){if(!t||!Array.isArray(t.milestones)||!Array.isArray(t.costData))throw new Error("Invalid data structure received from server.");return t}async function U(t){const e=`journeyData_v${t&&t.dataVersion?String(t.dataVersion):"1"}`;try{const o=localStorage.getItem(e);if(o){const a=JSON.parse(o);return P(a)}}catch(o){console.warn(`Ignoring corrupt cache for key: ${e}`,o),localStorage.removeItem(e)}try{const[o,a]=await Promise.all([fetch("data/milestones.json",{credentials:"same-origin"}),fetch("data/costData.json",{credentials:"same-origin"})]);if(!o.ok||!a.ok)throw new Error("Network response was not ok while fetching journey data.");const i=await o.json(),r=await a.json(),v={milestones:i.sort((D,b)=>new Date(D.date)-new Date(b.date)),costData:r};P(v);try{localStorage.setItem(e,JSON.stringify(v))}catch{}return v}catch(o){throw console.error("Failed to load journey data:",o),o}}const V=new Date().toLocaleDateString("sv-SE",{timeZone:"Australia/Perth"}),p=new Date(V),w=(t,n)=>Math.round((new Date(n)-new Date(t))/(1e3*60*60*24));function h(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function W(t){const n=t.filter(e=>{const o=w(p,new Date(e.date));return o>0&&o<=7});n.length>0&&"Notification"in window&&Notification.permission!=="denied"&&Notification.requestPermission().then(e=>{e==="granted"&&n.forEach(o=>{const a=w(p,new Date(o.date));new Notification("Upcoming PR Milestone",{body:`${o.title} is in ${a} day(s).`,icon:"/assets/android-chrome-192x192.png"})})})}function J(t,n,e){const o=document.querySelector(".main-content");if(!o)return;let a={points:{},costs:{}};const i=c=>o.querySelector(`#${c}`),r={currentPoints:i("currentPoints"),pointsProgress:i("pointsProgress"),pointsBreakdown:i("points-breakdown"),currentTotalPoints:i("currentTotalPoints"),costTracker:i("cost-tracker"),totalCostSpent:i("total_cost_spent"),totalSpentDisplay:i("totalSpentDisplay"),totalBudgetDisplay:i("totalBudgetDisplay"),investmentProgress:i("investmentProgress"),daysRemaining:i("daysRemaining"),visaStatus:i("visaStatus"),visaTimeProgress:i("visaTimeProgress"),nextMilestoneCountdown:i("nextMilestoneCountdown"),nextMilestoneTitle:i("nextMilestoneTitle"),milestoneProgress:i("milestoneProgress"),alertsContainer:i("alertsContainer"),pointsTargetDisplay:i("pointsTargetDisplay")};function f(){try{localStorage.setItem("prDashboardState",JSON.stringify(a))}catch{}}function v(){try{const c=JSON.parse(localStorage.getItem("prDashboardState")||"{}");return typeof c!="object"||!c?{points:{},costs:{}}:{points:{},costs:{},...c}}catch{return{points:{},costs:{}}}}function D(c,l,u){c.querySelectorAll(".interactive-checkbox:not(:disabled)").forEach(s=>{s.addEventListener("change",d=>{const m=d.target.dataset.id;a[l][m]=!!d.target.checked,f(),u()})})}const b=c=>new Intl.NumberFormat("en-AU",{style:"currency",currency:"AUD",minimumFractionDigits:0}).format(c),_=c=>{const l=new Date(c);let u=p.getFullYear()-l.getFullYear();const s=p.getMonth()-l.getMonth();return(s<0||s===0&&p.getDate()<l.getDate())&&u--,u};function q(){const c=_(e.userDOB),l=new Date(e.userDOB),u=l.getFullYear()+25,s=l.getMonth(),d=l.getDate(),m=new Date(u,s,d),g=t.find(E=>E.id==="jrp_complete"),y=g?g.date:null;return[{id:"age",label:"Age",points:30,currentPoints:c<25?25:30,achievedDate:c>=25?m.toISOString().slice(0,10):null,tooltip:"Points based on age at time of invitation."},{id:"english",label:"Superior English",points:20,currentPoints:10,tooltip:"Superior (e.g., IELTS 8 or equivalent in each PTE component) vs Proficient."},{id:"work_exp",label:"1 Year Aus Work Exp",points:5,currentPoints:0,achievedDate:y,tooltip:"Achieved after completing the 12-month Job Ready Program."},{id:"degree",label:"Bachelor Degree",points:15,currentPoints:15,initial:!0,tooltip:"Points for your Bachelor of IT degree from Griffith University."},{id:"study_req",label:"Australian Study Req",points:5,currentPoints:5,initial:!0,tooltip:"Two academic years of study in Australia."},{id:"naati",label:"Community Language",points:5,currentPoints:0,tooltip:"NAATI CCL (Hindi)."},{id:"regional",label:"Regional Study",points:5,currentPoints:5,initial:!0,tooltip:"Studied in a designated regional area."},{id:"single",label:"Single Applicant",points:10,currentPoints:10,initial:!0,tooltip:"Applying as a single applicant."}]}function L(){const c=q();let l=0;r.pointsBreakdown.innerHTML=c.map(s=>{const d=s.achievedDate&&new Date(s.achievedDate)<=p,m=!!a.points[s.id]||d||!!s.initial,g=m?s.points:s.currentPoints||0;return l+=g,`<div class="points-item">
        <input type="checkbox" class="interactive-checkbox" id="check_${h(s.id)}" data-id="${h(s.id)}" ${m?"checked":""} ${d?"disabled":""}>
        <label for="check_${h(s.id)}" class="item-label">${h(s.label)}</label>
        <div class="tooltip-wrapper">
          <span class="tooltip" aria-label="More info">(i)</span>
          <div class="tooltiptext">${h(s.tooltip)}</div>
        </div>
        <span class="points-value ${m?"points-achieved":"points-pending"}">${g}</span>
      </div>`}).join(""),r.currentTotalPoints.textContent=l,r.currentPoints.textContent=l,r.pointsProgress.style.width=`${Math.min(100,l/e.pointsTarget*100)}%`;const u=i("points-breakdown");u&&(D(u,"points",L),u.querySelectorAll(".tooltip-wrapper").forEach(s=>{s.addEventListener("click",d=>{document.querySelectorAll(".tooltip-wrapper.is-active").forEach(m=>{m!==s&&m.classList.remove("is-active")}),s.classList.toggle("is-active")})}))}function k(){const c=n.reduce((s,d)=>s+d.amount,0);let l=0;r.costTracker.innerHTML=n.map(s=>{const d=s.paid===!0,m=d||!!a.costs[s.id];return m&&(l+=s.amount),`<div class="cost-item">
          <input type="checkbox" class="interactive-checkbox" id="cost_${h(s.id)}" data-id="${h(s.id)}" ${m?"checked":""} ${d?"disabled":""}>
          <label for="cost_${h(s.id)}">${h(s.label)}</label>
          <span>${b(s.amount)}</span>
        </div>`}).join(""),r.totalCostSpent.textContent=b(l),r.totalSpentDisplay.textContent=b(l),r.totalBudgetDisplay.textContent=`Budget: ${b(c)}`,r.investmentProgress.style.width=c>0?`${Math.min(100,l/c*100)}%`:"0%";const u=i("cost-tracker");u&&D(u,"costs",k)}function F(){const c=t.find(y=>y.id==="visa_extend"),l=c&&new Date(c.date)<=p,u=l?e.finalVisaExpiryDate:e.initialVisaExpiryDate,s=w(p,u);r.daysRemaining.textContent=s>0?s:"BVA",r.visaStatus.textContent=l?"Expires Feb 2028 (Ext. Active)":"Expires Feb 2027 (Ext. Pending)";const d=Math.max(1,w(e.journeyStartDate,u)),m=Math.max(0,w(e.journeyStartDate,p));r.visaTimeProgress.style.width=`${Math.min(100,m/d*100)}%`,r.pointsTargetDisplay&&(r.pointsTargetDisplay.textContent=`Target: ${e.pointsTarget}`);const g=t.filter(y=>new Date(y.date)>p);if(g.length>0){const y=g[0];r.nextMilestoneCountdown.textContent=w(p,y.date),r.nextMilestoneTitle.textContent=h((y.title||"").replace(/[^\w\s]/gi,"").trim());const E=Math.max(0,t.findIndex(H=>H.id===y.id)-1),A=E>=0?new Date(t[E].date):new Date(e.journeyStartDate),O=Math.max(1,w(A,y.date)),z=Math.max(0,w(A,p));r.milestoneProgress.style.width=`${Math.min(100,z/O*100)}%`}else r.nextMilestoneCountdown.textContent="—",r.nextMilestoneTitle.textContent="All milestones completed",r.milestoneProgress.style.width="100%"}function j(){const c=t.find(g=>g.id==="visa_extend"),u=c&&new Date(c.date)<=p?e.finalVisaExpiryDate:e.initialVisaExpiryDate,s=w(p,u);let d=[];const m=t.find(g=>{const y=new Date(g.date);return y>=p&&w(p,y)<=14});m&&d.push({type:"info",msg:`<strong>Upcoming:</strong> ${h(m.title)}. This is happening now or in the next two weeks!`}),s<90&&s>0?d.push({type:"warning",msg:"<strong>Visa alert:</strong> Less than 90 days remaining on your current visa. Ensure next steps are taken!"}):s<365&&s>0&&d.push({type:"info",msg:"<strong>Visa alert:</strong> Less than one year remaining on your current visa."}),d.length===0&&d.push({type:"success",msg:"All systems are green. You are on track!"}),r.alertsContainer.innerHTML=d.map(g=>`<div class="alert ${g.type==="success"?"alert-success":g.type==="warning"?"alert-warning":g.type==="error"?"alert-error":"alert-info"}"><i class="fas fa-info-circle" aria-hidden="true"></i>${g.msg}</div>`).join("")}function N(){const c=s=>{confirm(s==="points"?"Are you sure you want to reset the points calculator?":"Are you sure you want to reset the investment tracker?")&&(s==="points"?(a.points={},L()):s==="costs"&&(a.costs={},k()),f(),window.scrollTo({top:0,behavior:"smooth"}))},l=i("resetDataBtn"),u=i("resetDataBtn2");l&&(l.addEventListener("click",()=>c("points")),l.title="Reset Points Calculator"),u&&(u.addEventListener("click",()=>c("costs")),u.title="Reset Investment Tracker")}a=v(),L(),k(),F(),j(),N(),W(t),o.querySelectorAll(".skeleton-item").forEach(c=>c.remove()),o.querySelectorAll(".metric-item, #points-breakdown > *, #cost-tracker > *").forEach(c=>{c.style.display==="none"&&(c.style.display="")})}function C(t,n="all"){const e=document.getElementById("timeline");if(!e)return;const o=t.filter(r=>n==="all"||r.phase===n),a=o.findLastIndex(r=>new Date(r.date+"T00:00:00")<=p),i=a>=0?(a+1)/o.length*100:0;e.innerHTML=`<div id="timeline-progress-fill" style="height: ${i}%"></div>`+o.map(r=>{const f=new Date(r.date+"T00:00:00"),v=f<=p,D=f.toLocaleDateString("en-AU",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"Australia/Perth"});return`
            <div class="milestone" data-phase="${r.phase}">
                <div class="milestone-header" data-id="${r.id}" aria-expanded="false" aria-controls="details_${r.id}">
                    <div class="milestone-icon ${v?"completed":"future"}">
                        <i class="fas fa-${v?"check":"hourglass-start"}"></i>
                    </div>
                    <div class="milestone-content">
                        <div class="milestone-title">${r.title}</div>
                        <div class="milestone-date">${D}</div>
                    </div>
                </div>
                <div class="milestone-details" id="details_${r.id}"><p>${r.details}</p></div>
            </div>`}).join(""),document.querySelectorAll(".milestone-header").forEach(r=>{const f=v=>{const b=document.getElementById(`details_${v.currentTarget.dataset.id}`).classList.toggle("visible");v.currentTarget.setAttribute("aria-expanded",b),b&&v.currentTarget.scrollIntoView({behavior:"smooth",block:"nearest"})};r.addEventListener("click",f)})}function Y(t){C(t);const n=document.querySelector(".toggle-btn-group");n&&(n.querySelectorAll(".toggle-btn").forEach(e=>{e.setAttribute("aria-pressed",e.classList.contains("active")?"true":"false")}),n.addEventListener("click",e=>{e.target.tagName==="BUTTON"&&(document.querySelectorAll(".toggle-btn").forEach(o=>{o.classList.remove("active"),o.setAttribute("aria-pressed","false")}),e.target.classList.add("active"),e.target.setAttribute("aria-pressed","true"),C(t,e.target.dataset.phase))}))}function G(){const t=document.getElementById("navigation-menu"),n=document.getElementById("hamburger-menu"),e=document.getElementById("close-menu"),o=document.getElementById("overlay"),a=()=>{document.body.classList.add("menu-is-open"),t&&(t.classList.add("is-open"),t.setAttribute("aria-hidden","false"),e&&e.focus()),o&&o.classList.add("is-visible")};n&&n.addEventListener("click",a),e&&e.addEventListener("click",S),o&&o.addEventListener("click",S)}function S(){const t=document.getElementById("navigation-menu"),n=document.getElementById("overlay"),e=document.getElementById("hamburger-menu");e&&e.focus(),document.body.classList.remove("menu-is-open"),t&&(t.classList.remove("is-open"),t.setAttribute("aria-hidden","true")),n&&n.classList.remove("is-visible")}function Z(){const t=document.getElementById("dark-mode-toggle");localStorage.getItem("theme")==="dark"&&(document.body.classList.add("dark-mode"),t&&(t.checked=!0)),t&&t.addEventListener("change",function(){document.body.classList.toggle("dark-mode",this.checked),localStorage.setItem("theme",this.checked?"dark":"light")})}function K(){if(document.getElementById("scrollToTopBtn"))return;document.body.insertAdjacentHTML("beforeend",'<a href="#" id="scrollToTopBtn" class="scroll-to-top-btn" title="Go to top" aria-label="Scroll to top"><i class="fas fa-chevron-up" aria-hidden="true"></i></a>');const n=document.getElementById("scrollToTopBtn");n&&(window.addEventListener("scroll",()=>{n.classList.toggle("visible",window.scrollY>300)}),n.addEventListener("click",e=>{e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})}))}function M(){const t=document.getElementById("currentDate"),n=document.getElementById("currentTime");if(t&&n){const e=new Date,o={timeZone:"Australia/Perth"};t.textContent=e.toLocaleDateString("en-AU",{weekday:"long",year:"numeric",month:"long",day:"numeric",...o}),n.textContent=e.toLocaleTimeString("en-AU",{hour12:!0,hour:"numeric",minute:"2-digit",second:"2-digit",...o}).toLowerCase()+" AWST"}}function X(){document.querySelectorAll(".copy-btn").forEach(t=>{if(t.dataset.bound==="1")return;t.dataset.bound="1";const n=t.querySelector(".tooltip-text");t.addEventListener("click",()=>{const e=t.dataset.copy||"";navigator.clipboard.writeText(e).then(()=>{if(n){const o=n.textContent;n.textContent="Copied!",t.classList.add("copied"),setTimeout(()=>{n.textContent=o||"Copy",t.classList.remove("copied")},1200)}}).catch(o=>console.error("Failed to copy text: ",o))})})}function Q(){const t=document.querySelector("img.profile-picture");t&&t.addEventListener("error",()=>{t.src="https://placehold.co/180x180/00529B/FFFFFF?text=RG"},{once:!0})}function tt(){document.addEventListener("click",t=>{t.target.closest(".tooltip-wrapper")||document.querySelectorAll(".tooltip-wrapper.is-active").forEach(n=>{n.classList.remove("is-active")})})}function B(t=location.pathname){const n=o=>(o||"").replace(location.origin,"").split(/[?#]/)[0].replace(/\/index\.html$/i,"/")||"/",e=n(t);document.querySelectorAll("nav a, #navigation-menu a, header a[data-nav], .site-nav a").forEach(o=>{const a=o.getAttribute("href");if(!a||a.startsWith("#")||a.startsWith("mailto:")){o.classList.remove("active","is-active"),o.removeAttribute("aria-current");return}let i=a;try{i=new URL(a,location.origin).pathname}catch{}const f=n(i)===e;o.classList.toggle("active",f),o.classList.toggle("is-active",f),f?o.setAttribute("aria-current","page"):o.removeAttribute("aria-current")})}function et(){const t=document.getElementById("copyright-year");t&&(t.textContent=new Date().getFullYear())}function nt(){if(document.getElementById("update-toast"))return;const t=document.createElement("div");t.id="update-toast",t.className="update-toast",t.innerHTML=`
        <span>A new version is available!</span>
        <button id="reload-button" class="toast-button">Reload</button>
        <button id="close-toast-button" class="toast-close-button" aria-label="Close">&times;</button>
    `,document.body.appendChild(t),document.getElementById("reload-button").addEventListener("click",()=>{window.location.reload()}),document.getElementById("close-toast-button").addEventListener("click",()=>{t.remove()});const n=document.createElement("style");n.textContent=`
    .update-toast {
      position: fixed;
      bottom: -100px;
      left: 50%;
      transform: translateX(-50%);
      background-color: var(--primary-darker);
      color: white;
      padding: 1rem 1.5rem;
      border-radius: var(--border-radius-md);
      box-shadow: var(--shadow-medium);
      z-index: 2000;
      display: flex;
      align-items: center;
      gap: 1rem;
      transition: bottom 0.5s ease-in-out;
    }
    .toast-button {
      background-color: var(--secondary-color);
      color: var(--primary-darker);
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 50px;
      font-weight: bold;
      cursor: pointer;
    }
    .toast-close-button {
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      line-height: 1;
      cursor: pointer;
      padding: 0 0.5rem;
    }
  `,document.head.appendChild(n),setTimeout(()=>{t.style.bottom="20px"},100)}function $(){G(),Z(),K(),tt(),et(),Q(),document.getElementById("currentDate")&&(M(),setInterval(M,1e3)),document.querySelector(".copy-btn")&&X()}const R={"/":{file:"index.html",title:"PR Journey Dashboard"},"/about":{file:"about.html",title:"About Me"},"/plan":{file:"plan.html",title:"My PR Plan"},"/visa":{file:"visa.html",title:"Visa Background"},"/documents":{file:"documents.html",title:"Documents Hub"},"/contact":{file:"contact.html",title:"Contact"}},I=".main-content";function x(t){let e=new URL(t,window.location.origin).pathname;return e=e.replace(/\/{2,}/g,"/"),e.length>1&&e.endsWith("/")&&(e=e.slice(0,-1)),e||"/"}function ot(t){const n=new URL(t.href,window.location.origin);return n.origin===window.location.origin&&R.hasOwnProperty(n.pathname.replace(/\/{2,}/g,"/").replace(/\/$/,"")||"/")}async function T(t){const n=R[t],e=document.querySelector(I);e&&(e.classList.add("fade-out"),setTimeout(async()=>{if(!n){e.innerHTML=`<div class="card"><div class="card-header"><i class="fas fa-exclamation-triangle"></i> Page not found</div><p>We couldn't find <code>${t}</code>. Try the <a href="/">Dashboard</a>.</p></div>`,B("/"),document.title="Not Found | Australian PR Journey",e.classList.remove("fade-out");return}try{const o=await fetch(n.file,{credentials:"same-origin"});if(!o.ok)throw new Error("Failed to fetch page");const a=await o.text(),i=new DOMParser().parseFromString(a,"text/html"),r=i.querySelector(I);if(!r)throw new Error("Malformed page: missing main content");e.innerHTML=r.innerHTML,document.title=i.title||`🇦🇺 Australian PR Journey | ${n.title}`;const f=document.getElementById("page-title");f&&(f.textContent=n.title),B(t),typeof window.__afterRoute=="function"&&window.__afterRoute(t),window.scrollTo({top:0,behavior:"smooth"})}catch(o){console.error(o),e.innerHTML=`<div class="card"><div class="card-header"><i class="fas fa-wifi"></i> Network error</div><p>We couldn't load this page. Please try again.</p></div>`}finally{e.classList.remove("fade-out")}},300))}function it(t){window.__afterRoute=t,document.addEventListener("click",n=>{const e=n.target.closest("a[href]");if(!e)return;const o=e.getAttribute("href")||"";if(o.startsWith("#"))return;const a=new URL(o,window.location.origin);if(a.hash&&a.pathname===window.location.pathname||!ot(e))return;n.preventDefault(),S();const i=x(e.getAttribute("href"));i!==x(location.pathname)&&(history.pushState({},"",i),T(i))}),window.addEventListener("popstate",()=>{T(x(location.pathname))}),T(x(location.pathname))}function at(t){const n=document.querySelector(".document-table tbody");n&&(n.innerHTML=t.map(e=>{let o="";return e.status==="Obtained"?o="status-green":e.status==="Booked"?o="status-orange":e.status==="Required"&&(o="status-red"),`
      <tr>
        <td data-label="Document"><i class="fas ${h(e.icon)}"></i> ${h(e.document)}</td>
        <td data-label="Status"><span class="status-badge ${o}">${h(e.status)}</span></td>
        <td data-label="Notes / Expiry">${h(e.notes)}</td>
      </tr>
    `}).join(""))}async function rt(){try{const t=await fetch("/data/documents.json");if(!t.ok)throw new Error("Failed to load documents data");const n=await t.json();at(n)}catch(t){console.error("Could not initialize documents page:",t)}}const st={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};function ct(){const t=document.createElement("div");t.className="config-error-banner",t.textContent="⚠️ Could not load live configuration. Displaying default data. Some information may be outdated.",document.body.prepend(t);const n=document.createElement("style");n.textContent=`
    .config-error-banner {
      background-color: #D32F2F;
      color: white;
      text-align: center;
      padding: 0.75rem;
      font-weight: 500;
      font-size: 0.9rem;
    }
  `,document.head.appendChild(n)}function lt(t){const n=document.querySelector(".main-content");n&&(n.innerHTML=`<div class="card"><div class="card-header"><i class="fas fa-exclamation-triangle"></i> Application Error</div><p>${t}</p></div>`,n.classList.remove("fade-out"))}async function dt(){try{const t=await fetch("data/config.json",{credentials:"same-origin"});if(!t.ok)throw new Error(`Failed to load config: ${t.statusText}`);return await t.json()}catch(t){return console.error("Config load failed, falling back to defaults",t),ct(),{userDOB:"2001-05-18",journeyStartDate:"2025-02-15",initialVisaExpiryDate:"2027-02-15",finalVisaExpiryDate:"2028-02-15",pointsTarget:95,dataVersion:1}}}async function ut(){try{if("serviceWorker"in navigator)if(import.meta&&st){const a=await navigator.serviceWorker.register("/sw.js");a.addEventListener("updatefound",()=>{const i=a.installing;i&&i.addEventListener("statechange",()=>{i.state==="installed"&&navigator.serviceWorker.controller&&nt()})})}else try{const a=await navigator.serviceWorker.getRegistrations();for(const i of a)await i.unregister().catch(()=>{})}catch{}$();const t=await dt(),{milestones:n,costData:e}=await U(t);it(a=>{$(),document.querySelector(".key-metrics-panel")&&J(n,e,t),document.getElementById("timeline")&&Y(n),document.querySelector(".document-table")&&rt()})}catch(t){console.error("Fatal error during application initialization:",t),lt("Could not load the application due to a critical error. Please try refreshing the page.")}}document.addEventListener("DOMContentLoaded",ut);
